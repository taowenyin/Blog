---
title: 【2020】Identifying Autism Spectrum Disorder From Resting-State fMRI Using Deep Belief Network
mathjax: true
date: 2020-08-06 22:28:44
updated: {{ date }}
tags: [MRI, 深度学习]
categories: [ASD, 图巻积网络]
---

# 介绍

作者提出了一种使用深度信念网络（DBN）的图分类模型。

1、首先，利用基于图的特征选择方法（GBFS）从外部和内部两个方面来选择ASD的显著功能关联性（FCs）。

2、然后，实现了一种基于有限路径的深度优先搜索（RP-DFS）算法，进一步挖掘图上隐含的拓扑信息。

3、最后，提出一种具有自动超参数调节功能的三层DBN来识别ASD患者。

# 相关工作

## 特征选择策略

主要的特征选择策略有三种，分别是过滤法、包装发和嵌入法。

**1、过滤法**中群体水平统计检验（group-level statistical test）是最常用的犯法，例如t检验（t-test）、秩和检验（rank sum test）、Welch T检验（welch's t-test）。这种方法最主要的问题是特征的选择主要依赖于$p$值，而$p$值有时无法反应出对分类影响最大的那个特征。基于相关性选择也是过滤法的一种。

**2、包装发**通过最终分类器的性能来组合不同的特征，从而实现降维。递归式特征消除（RFE）和遗传算法（GA）就是两种应用广泛的包装方法。其中，递归式特征消除（RFE）通过不过逐步减少特征组合来优化分类器。而GA通过初始化种群，然后通过遗传、变异等方法来获得高质量的特征组合。

**3、嵌入法**与包装法类似，是将特征选择集成到特定分类器的决策过程中，而不同点在于使用固定的模型来构建度量。LASSO是最常用的嵌入法，通过增加惩罚项来减少模型的复杂度和缓解过拟合。

**多任务特征学习**最近的热点，通过忽略数据中的噪声来找到整合出模型中高度一直的相关特征。此外，还有**稀疏学习**通过$L_{1, 2}$正则项来稀疏所有特征从而获得所需要的特征。

但是这些方法都存在一个问题就是与特定的分类器相关，因此所选择的特征就不能很好的对ASD中的连接模式进行解释。**所以作者出了一种基于rs-fMRI数据内部和外部度量的图特征选择方法（GBFS）。**

## 分类方法

传统的机器学习方法由于都是浅层或线性模型，因此在大规模数据集上，ML无法捕捉到脑网络中的拓扑信息以及连通性特征与临床表现之间的关系。**作者提出了一个带有超参数自动调整技术的三层深度信念网络（DBN）来进行分类。**

# 模型设计

基本步骤

1、首先、通过预处理流水线从原始的rs-fMRI数据中提取ROI的平均时间序列，然后转换成二维特征矩阵$T$，其中$T_{ik}$代表第$i$个ROI的第$k$个时间戳的平均时间序列。

2、然后使用基于图的特征选择（GBFS）从外部和内部两个方面选择显著的自闭症功能连接来进行图的创建。

3、接着使利用拓扑信息和用有限路径的深度优先搜索（RP-DFS）方法来充实图的表达。

4、最后，建立了一个三层DBN模型，并通过自动调整超参数来优化其配置设置。

{% asset_img flowchart-of-model.png 模型流程图 %}

图1：模型流程图

## 基于图的特征选择（GBFS）

通过PPC得到了19900个特征（200个ROI，$(200 \times(200-1) / 2)=19900$）。

基本步骤

1、外部度量

（1）选择ASD中显著的特征

>* 合并ASD的数据集，并计算每个连接性的均值（表示为$mean(FC_{ASD})$）和全局的均值（$mean_{ASD}$），以及全局标准差（$STD_{ASD}$）。
>* 这些连接性的均值$mean(FC_{ASD}(i, j))$与$mean_{ASD}$的差值高或低$\alpha \times STD_{ASD}$被认为是满足条件。其中，筛选因子$\alpha$用于控制所选连接数的数量。

（2）选择的特征在ASD组和对照组之间必须具有区分性

换言之，结合第一个标准，选择的连接在ASD组应该是显著的，而在TC组是不显著的。

$$\left\{\begin{array}{l}
\left\|mean\left(FC_{ASD}(i, j)\right)-mean_{ASD}\right\|>\alpha * STD_{ASD} \\
\left\|mean\left(FC_{TC}(i, j)\right)-mean_{TC}\right\| \leq \alpha * STD_{TC}
\end{array}\right.$$

其中$\alpha$一般设置为1。通过这样的选择得到了81个合格的连接性。

{% asset_img emarkable-connections-selected.png 特征选择算法相反时的结果 %}

图2：特征选择算法相反时的结果

{% asset_img visualization-of-brain-networks.png 脑网络可视化 %}

图3：从不同方向观察ASD和TC组的脑网络。

2、内部度量

使用KNN的图扩展在外部度量的基础上构建图来发现ROI的潜在联系，并且作者假设ASD的神经元活动可能是潜在相关区域的协同激活模式，而不是单个区域间的连接相互作用，因此显著的链接周围的ROI都不属于该链接。

（1）首先用连接$Node_{d}$和$Node_{t}$的边来初始化图。

（2）然后通过基于欧式距离的KNN创建每个节点的子图。

（3）节点$Node_{d}$和$Node_{t}$的子图添加到图中，节点之间的权重通过PCC计算得到。

（4）在为每个显著链接使用GBFS后，FC特征就变为$81 \times(K+1)^{2}=3969$，本文中的$K=6$，再过滤掉681个重复连接，最后剩3288个特征$((3288 / 19900) \times 100 \%)$，为原始特征数的$16.52\%$。

{% asset_img graph-extension-of-K-nearest-neighbors.png KNN的图扩展 %}

图4：通过KNN的图扩展来构建图

算法1：GBFS的伪代码

{% asset_img gbfs.png GBFS算法 %}

## 有限路径的深度优先搜索（RP-DFS）算法

设计了基于受限路径的深度优先搜索算法RP-DFS，来细化通过GBFS得到的FC特征矩阵，并遍历每个用于连接两个ROI之间的所有潜在路径。所谓有限路径（表示为$P$）就是定义两个ROI之间在限定步数内的一组连接。给定两个目标ROI分别是$R_{i}$和$R_{j}$和两个假设。

1、如果$R_{i}$和$R_{j}$与另一个$R_{k}$连接，那么可以表示为$R_{i} \leftrightarrow R_{k}$和$R_{j} \leftrightarrow R_{k}$，但$R_{i}$和$R_{j}$之间没有联系，那么$R_{i}$和$R_{j}$被认为在图中有一个半显著的联系，其权重应该随着路径的延长而相对减少。

2、发现连接两个ROI的受限路径越多，它们就越有可能具有很强的相关性。从$R_{i}$和$R_{j}$之间所有的潜在路径整合累计贡献作为最终得分。

$$score\left(R_{i}, R_{j}\right)=\sum_{t=1}^{N_{i j}}\left(\prod W\left(P_{t}\right)\right)^{F_{decay}\left(P_{t}\right)}$$

$$F_{decay}(P)=\beta \times(len(P)-1)$$

其中$N_{i j}$表示在$R_{i}$和$R_{j}$之间最大的受限路径长度。$\beta$表示从1.5到3之间的衰减因子，$W\left(P_{t}\right)$表示在路径$P$上第$t$个连接的权重，$F_{decay}(P)$是指数衰减函数，赋予较长路径较低的置信度。本文中$N_{i j}=2$。

除了已有的3288个$R_{i} \leftrightarrow R_{k}$连接外，使用RP-DFS算法还发现了7712个$R_{i} \leftrightarrow R_{k} \leftrightarrow R_{j}$连接。因此，对于每个数据集，图中的显著和半显著连接涉及总共125639条潜在路径。将所涉及的$（3288+7712=11000）$个连接的最终得分转换为尺寸为$110 \times 100$的二维矩阵进行分类。

算法2：RP-DFS的伪代码

{% asset_img rp-dfs.png RP-DFS算法 %}

## 带自动调参的DBN模型

DBN的训练通常分为两步：无监督的预训练和有监督的微调。

1、在无监督的预训练中，DBN的各层反复学习以概率方式重建无标签的可见单元。将RBMs中可见层和隐藏层的激活函数分别设置为Affine函数和Sigmoid函数（类似于AE）。

2、在监督学习中使用RMSProp优化算法和动量技术作为反向传播方法（其中激活函数是ReLU）对生成的网络进行微调。输出的激活函数为Softmax函数，产生每个类别的概率。

为了计算估计值和真实值之间的差异，无监督学习和有监督学习都使用相同的损失函数，即交叉熵。为了减少过拟合，采用了Dropout正则化方法。

本文首次将基于高斯过程的贝叶斯优化（BO）自动超参数调整技术应用于精神疾病的计算诊断。

$$x^{*}=\arg \max _{x \in \mathcal{X} \subseteq \mathbb{R}^{d}} f(x)$$

其中$\mathcal{X}$是全局优化中感兴趣的特定空间。假设$f$未知，BO的顺序设计策略首先把$f$看成一个随机函数，然后在它上面加上一个优先权。然后从功能评估中收集测试的数据，用更新的先验值近似$f$上的后验分布。反之，后验分布可以被用来构造一下函数$f$。

{% asset_img three-layer-dbn-classifier.png 三层DBN分类器 %}

图5：基于BO、DE或PSO的自动调参优化的三层DBN分类器